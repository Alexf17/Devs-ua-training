{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,S,oDAMA,MAAMC,EAAe,IAAI,EAAAC,EAAAC,SAEzB,IAAIC,EAAkBC,KAAKC,MAAMC,aAAaC,QAAQ,qBAAuB,CAC3EC,MAAO,GACPC,QAAS,IAE4B,IAAnCN,EAAgBM,QAAQC,OAC1BZ,EAAAa,KAAKC,kBAAkBC,YAAc,YAAYV,EAAgBM,QAAQC,SAC/B,IAAjCP,EAAgBK,MAAME,SAE/BZ,EAAAa,KAAKG,gBAAgBD,YAAc,SAASV,EAAgBK,MAAME,UAEpEZ,EAAAa,KAAKI,SAASC,iBAAiB,SAc/BC,eAA+BC,GAG7B,GAFAC,QAAQC,IAAIC,QACZH,EAAMI,iBACiD,MAAnDJ,EAAMK,OAAOC,WAAWC,cAAcC,SACxC,OAEF,IAAIC,EAAaT,EAAMK,OAAOC,WAAWC,cAAcG,GAEvD5B,EAAa6B,OAASF,EAEtB,MAAMG,QAAoB9B,EAAa+B,YAEjCC,QAUR,SAA+BC,GAC7B,MAAMC,YACJA,EAAWC,eACXA,EACAC,MAAAC,EAAKC,aACLA,EAAYC,WACZA,EAAUC,OACVA,EAAMC,WACNA,EAAUC,SACVA,EAAQd,GACRA,GACEK,EACEU,EAAaH,EAAOI,KAAI,EAACC,KAAEA,KAAWA,IAAMC,KAAK,MA0BvD,MAzBe,4GAA4GZ,iBAChHG,sHAGsBA,wdAS6CC,gDAA2DC,0DACjGE,mDACAN,EAAeY,+DACfJ,0HAIHD,wGAEgBd,uJACAA,6G,CA9ChCoB,CAAsBlB,EAAYG,OACvD,EAAAgB,EAAAC,eAAcpD,EAAAa,KAAKwC,eAkDrB,SAA+BnB,GAC7BlC,EAAAa,KAAKwC,cAAcC,mBAAmB,YAAapB,E,CAlDnDqB,CAAsBrB,GAEtBlC,EAAAa,KAAK2C,WAAWC,UAAUC,OAAO,mBACjCC,EAAY3B,EAAYG,KACxBd,QAAQC,IAAIqC,E,IA/Bd3D,EAAAa,KAAK+C,WAAW1C,iBAAiB,SAgFjC,WACElB,EAAAa,KAAK2C,WAAWC,UAAUI,IAAI,oBAC9B,EAAAV,EAAAC,eAAcpD,EAAAa,KAAKwC,c,IAjFrBrD,EAAAa,KAAKwC,cAAcnC,iBAAiB,SAwFpC,SAAyB4C,GAGvB,GADAzC,QAAQC,IAAIqC,GACc,WAAtBG,EAAErC,OAAOG,SACX,OAGF,GAAgC,YAA5BkC,EAAErC,OAAOsC,QAAQC,OAAsB,CACzC,IAAIC,EAAQN,EAEZtD,EAAgBM,QAAQuD,KAAKD,GACU,IAAnC5D,EAAgBM,QAAQC,SAC1BZ,EAAAa,KAAKC,kBAAkBC,YAAc,YAAYV,EAAgBM,QAAQC,UAE3EJ,aAAa2D,QAAQ,kBAAmB7D,KAAK8D,UAAU/D,G,CAGzD,GAAgC,UAA5ByD,EAAErC,OAAOsC,QAAQC,OAAoB,CACvC,IAAIK,EAASV,EAEbtD,EAAgBK,MAAMwD,KAAKG,GAEY,IAAnChE,EAAgBM,QAAQC,SAC1BZ,EAAAa,KAAKG,gBAAgBD,YAAc,SAASV,EAAgBK,MAAME,UAEpEJ,aAAa2D,QAAQ,kBAAmB7D,KAAK8D,UAAU/D,G,KAhH3DL,EAAAa,KAAKC,kBAAkBI,iBAAiB,SAGxC,YACE,EAAAiC,EAAAC,eAAcpD,EAAAa,KAAKI,S,IAHrBjB,EAAAa,KAAKG,gBAAgBE,iBAAiB,SAMtC,YACE,EAAAiC,EAAAC,eAAcpD,EAAAa,KAAKI,S,IAErB,IAAI0C,EAAY","sources":["src/js/modal-filmoteka.js"],"sourcesContent":["import { refs } from './refs';\nimport MovieService from './film-api';\nimport { genresList } from './genres-list';\nimport { title } from 'process';\nimport { cleanerMarkup } from './createMarkUp';\n\nconst movieService = new MovieService();\n\nlet saveDataStorage = JSON.parse(localStorage.getItem('saveDataStorage')) || {\n  queue: [],\n  watched: [],\n};\nif (saveDataStorage.watched.length !== 0) {\n  refs.watchedHederBtnEl.textContent = `watched  ${saveDataStorage.watched.length}`;\n} else if (saveDataStorage.queue.length !== 0) {\n  // console.log(saveDataStorage.watched.length);\n  refs.queueHederBtnEl.textContent = `queue ${saveDataStorage.queue.length}`;\n}\nrefs.filmList.addEventListener('click', onFilmItemClick);\nrefs.closeBtnEl.addEventListener('click', onCloseFilmModal);\nrefs.modalFilmWrap.addEventListener('click', onModalBtnClick);\nrefs.watchedHederBtnEl.addEventListener('click', onWatchedHederBtnClick);\nrefs.queueHederBtnEl.addEventListener('click', onQueueHederBtnClick);\n\nfunction onWatchedHederBtnClick() {\n  cleanerMarkup(refs.filmList);\n}\n\nfunction onQueueHederBtnClick() {\n  cleanerMarkup(refs.filmList);\n}\nlet filmArray = {};\nasync function onFilmItemClick(event) {\n  console.log(window);\n  event.preventDefault();\n  if (event.target.parentNode.parentElement.nodeName !== 'A') {\n    return;\n  }\n  let filmCardId = event.target.parentNode.parentElement.id;\n  // console.dir(event.target.parentNode.parentElement);\n  movieService.filmId = filmCardId;\n\n  const backendData = await movieService.fetchById();\n\n  const markup = await createFilmModalMarkup(backendData.data);\n  cleanerMarkup(refs.modalFilmWrap);\n  renderFilmModalMarkup(markup);\n\n  refs.backdropEl.classList.remove('visually-hidden');\n  filmArray = backendData.data;\n  console.log(filmArray);\n}\n\n// console.log(await filmArray);\nfunction createFilmModalMarkup(data) {\n  const {\n    poster_path,\n    original_title,\n    title,\n    vote_average,\n    vote_count,\n    genres,\n    popularity,\n    overview,\n    id,\n  } = data;\n  const genreItems = genres.map(({ name }) => name).join(', ');\n  const markup = `<div class=\"modal-film-image-wrap\"><img class=\"modal-film-image\" src=\"https://image.tmdb.org/t/p/original${poster_path}\n    \" alt=\"${title}\" width=\"375\" height=\"478\">\n    </div>\n    <div class=\"modal-film-info-wrap\">\n    <h2 class=\"modal-film-title\">${title}</h2>\n    <div class=\"modal-film-info-list\">\n    <ul class=\"modal-film-properties-list\">\n      <li class=\"modal-film-properties-item\">Vote/Votes</li>\n      <li class=\"modal-film-properties-item\">Popularity</li>\n      <li class=\"modal-film-properties-item\">Original Title</li>\n      <li class=\"modal-film-properties-item\">Genre</li>\n    </ul>\n    <ul class=\"modal-film-value-list\">\n      <li class=\"modal-film-value-item\"><span class=\"modal-film-vote-average\">${vote_average}</span>/<span class=\"modal-film-vote-count\">${vote_count}</span></li>\n      <li class=\"modal-film-value-item\">${popularity}</li>\n      <li class=\"modal-film-value-item\">${original_title.toUpperCase()}</li>\n      <li class=\"modal-film-value-item\">${genreItems}</li>\n    </ul>\n    </div>\n    <h3 class=\"modal-film-about-title\">ABOUT</h3>\n    <p class=\"modal-film-about-text\">${overview}</p>\n    <ul class=\"modal-film-button-list\">\n      <li class=\"modal-film-button-item\"><button id=\"${id}\" class=\"modal-film-button\" type=\"button\" data-action='watched'>ADD TO WATCHED</button></li>\n      <li class=\"modal-film-button-item\"><button id=\"${id}\" class=\"modal-film-button\" type=\"button\" data-action='queue'>ADD TO QUEUE</button></li>\n    </ul> </div>`;\n  return markup;\n}\n\nfunction renderFilmModalMarkup(markup) {\n  refs.modalFilmWrap.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction onCloseFilmModal() {\n  refs.backdropEl.classList.add('visually-hidden');\n  cleanerMarkup(refs.modalFilmWrap);\n}\n\n// добавили слушателя после рендера кнопок\n// refs.queueModalBtnEl.addEventListener(\"click\", onQueueModalBtnClick);\n// refs.watchedModalBtnEl.addEventListener(\"click\", onWatchedModalBtnClick);\n\nfunction onModalBtnClick(e) {\n  // const filmArray =\n  console.log(filmArray);\n  if (e.target.nodeName !== 'BUTTON') {\n    return;\n  }\n\n  if (e.target.dataset.action === 'watched') {\n    let value = filmArray;\n\n    saveDataStorage.watched.push(value);\n    if (saveDataStorage.watched.length !== 0) {\n      refs.watchedHederBtnEl.textContent = `watched  ${saveDataStorage.watched.length}`;\n    }\n    localStorage.setItem('saveDataStorage', JSON.stringify(saveDataStorage));\n  }\n\n  if (e.target.dataset.action === 'queue') {\n    let value2 = filmArray;\n\n    saveDataStorage.queue.push(value2);\n\n    if (saveDataStorage.watched.length !== 0) {\n      refs.queueHederBtnEl.textContent = `queue ${saveDataStorage.queue.length}`;\n    }\n    localStorage.setItem('saveDataStorage', JSON.stringify(saveDataStorage));\n  }\n}\n"],"names":["$krGWQ","parcelRequire","$b7eb70fc4c285a09$var$movieService","$8sSZi","default","$b7eb70fc4c285a09$var$saveDataStorage","JSON","parse","localStorage","getItem","queue","watched","length","refs","watchedHederBtnEl","textContent","queueHederBtnEl","filmList","addEventListener","async","event","console","log","window","preventDefault","target","parentNode","parentElement","nodeName","filmCardId","id","filmId","backendData","fetchById","markup","data","poster_path","original_title","title","title1","vote_average","vote_count","genres","popularity","overview","genreItems","map","name","join","toUpperCase","$b7eb70fc4c285a09$var$createFilmModalMarkup","$1vg23","cleanerMarkup","modalFilmWrap","insertAdjacentHTML","$b7eb70fc4c285a09$var$renderFilmModalMarkup","backdropEl","classList","remove","$b7eb70fc4c285a09$var$filmArray","closeBtnEl","add","e","dataset","action","value","push","setItem","stringify","value2"],"version":3,"file":"films.db28c6d4.js.map"}