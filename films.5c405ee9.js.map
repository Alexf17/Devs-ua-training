{"mappings":"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","sources":["src/js/modal-filmoteka.js"],"sourcesContent":["import { refs } from './refs';\nimport MovieService from './film-api';\nimport { genresList } from './genres-list';\nimport { title } from 'process';\nimport { cleanerMarkup } from './createMarkUp';\n\nconst movieService = new MovieService();\n\nlet saveDataStorage = JSON.parse(localStorage.getItem('saveDataStorage')) || {\n  queue: [],\n  watched: [],\n};\nif (saveDataStorage.watched.length !== 0) {\n  refs.watchedHederBtnEl.textContent = `watched  ${saveDataStorage.watched.length}`;\n} else if (saveDataStorage.queue.length !== 0) {\n  // console.log(saveDataStorage.watched.length);\n  refs.queueHederBtnEl.textContent = `queue ${saveDataStorage.queue.length}`;\n}\nrefs.filmList.addEventListener('click', onFilmItemClick);\nrefs.closeBtnEl.addEventListener('click', onCloseFilmModal);\nrefs.modalFilmWrap.addEventListener('click', onModalBtnClick);\nrefs.watchedHederBtnEl.addEventListener('click', onWatchedHederBtnClick);\nrefs.queueHederBtnEl.addEventListener('click', onQueueHederBtnClick);\n\nfunction onWatchedHederBtnClick() {\n  cleanerMarkup(refs.filmList);\n}\n\nfunction onQueueHederBtnClick() {\n  cleanerMarkup(refs.filmList);\n}\nlet filmArray = {};\nasync function onFilmItemClick(event) {\n  console.log(window);\n  event.preventDefault();\n  if (event.target.parentNode.parentElement.nodeName !== 'A') {\n    return;\n  }\n  let filmCardId = event.target.parentNode.parentElement.id;\n  // console.dir(event.target.parentNode.parentElement);\n  movieService.filmId = filmCardId;\n\n  const backendData = await movieService.fetchById();\n\n  const markup = await createFilmModalMarkup(backendData.data);\n  cleanerMarkup(refs.modalFilmWrap);\n  renderFilmModalMarkup(markup);\n\n  refs.backdropEl.classList.remove('visually-hidden');\n  filmArray = backendData.data;\n  console.log(filmArray);\n}\n\n// console.log(await filmArray);\nfunction createFilmModalMarkup(data) {\n  const {\n    poster_path,\n    original_title,\n    title,\n    vote_average,\n    vote_count,\n    genres,\n    popularity,\n    overview,\n    id,\n  } = data;\n  const genreItems = genres.map(({ name }) => name).join(', ');\n  const markup = `<div class=\"modal-film-image-wrap\"><img class=\"modal-film-image\" src=\"https://image.tmdb.org/t/p/original${poster_path}\n    \" alt=\"${title}\" width=\"375\" height=\"478\">\n    </div>\n    <div class=\"modal-film-info-wrap\">\n    <h2 class=\"modal-film-title\">${title}</h2>\n    <div class=\"modal-film-info-list\">\n    <ul class=\"modal-film-properties-list\">\n      <li class=\"modal-film-properties-item\">Vote/Votes</li>\n      <li class=\"modal-film-properties-item\">Popularity</li>\n      <li class=\"modal-film-properties-item\">Original Title</li>\n      <li class=\"modal-film-properties-item\">Genre</li>\n    </ul>\n    <ul class=\"modal-film-value-list\">\n      <li class=\"modal-film-value-item\"><span class=\"modal-film-vote-average\">${vote_average}</span>/<span class=\"modal-film-vote-count\">${vote_count}</span></li>\n      <li class=\"modal-film-value-item\">${popularity}</li>\n      <li class=\"modal-film-value-item\">${original_title.toUpperCase()}</li>\n      <li class=\"modal-film-value-item\">${genreItems}</li>\n    </ul>\n    </div>\n    <h3 class=\"modal-film-about-title\">ABOUT</h3>\n    <p class=\"modal-film-about-text\">${overview}</p>\n    <ul class=\"modal-film-button-list\">\n      <li class=\"modal-film-button-item\"><button id=\"${id}\" class=\"modal-film-button\" type=\"button\" data-action='watched'>ADD TO WATCHED</button></li>\n      <li class=\"modal-film-button-item\"><button id=\"${id}\" class=\"modal-film-button\" type=\"button\" data-action='queue'>ADD TO QUEUE</button></li>\n    </ul> </div>`;\n  return markup;\n}\n\nfunction renderFilmModalMarkup(markup) {\n  refs.modalFilmWrap.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction onCloseFilmModal() {\n  refs.backdropEl.classList.add('visually-hidden');\n  cleanerMarkup(refs.modalFilmWrap);\n}\n\n// добавили слушателя после рендера кнопок\n// refs.queueModalBtnEl.addEventListener(\"click\", onQueueModalBtnClick);\n// refs.watchedModalBtnEl.addEventListener(\"click\", onWatchedModalBtnClick);\n\nfunction onModalBtnClick(e) {\n  // const filmArray =\n  console.log(filmArray);\n  if (e.target.nodeName !== 'BUTTON') {\n    return;\n  }\n\n  if (e.target.dataset.action === 'watched') {\n    let value = filmArray;\n\n    saveDataStorage.watched.push(value);\n    if (saveDataStorage.watched.length !== 0) {\n      refs.watchedHederBtnEl.textContent = `watched  ${saveDataStorage.watched.length}`;\n    }\n    localStorage.setItem('saveDataStorage', JSON.stringify(saveDataStorage));\n  }\n\n  if (e.target.dataset.action === 'queue') {\n    let value2 = filmArray;\n\n    saveDataStorage.queue.push(value2);\n\n    if (saveDataStorage.watched.length !== 0) {\n      refs.queueHederBtnEl.textContent = `queue ${saveDataStorage.queue.length}`;\n    }\n    localStorage.setItem('saveDataStorage', JSON.stringify(saveDataStorage));\n  }\n}\n"],"names":["$bpxeT","parcelRequire","$4e3b4b7910be1058$var$movieService","$9TUSr","default","$4e3b4b7910be1058$var$saveDataStorage","JSON","parse","localStorage","getItem","queue","watched","length","$4Nugj","refs","watchedHederBtnEl","textContent","concat","queueHederBtnEl","filmList","addEventListener","event","$4e3b4b7910be1058$var$_onFilmItemClick","apply","this","arguments","closeBtnEl","backdropEl","classList","add","$5hsTI","cleanerMarkup","modalFilmWrap","e","console","log","$4e3b4b7910be1058$var$filmArray","target","nodeName","dataset","action","value","push","setItem","stringify","value2","$parcel$interopDefault","$2TvXO","mark","_callee","filmCardId","backendData","markup","window","preventDefault","parentNode","parentElement","id","filmId","fetchById","_ctx","sent","$4e3b4b7910be1058$var$createFilmModalMarkup","data","$4e3b4b7910be1058$var$renderFilmModalMarkup","remove","poster_path","original_title","title1","title","vote_average","vote_count","genres","popularity","overview","genreItems","map","param","name","join","toUpperCase","insertAdjacentHTML"],"version":3,"file":"films.5c405ee9.js.map"}